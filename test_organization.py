#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
–¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
"""

from pdf_processor import PDFProcessor
import json

# –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (–∫–∞–∫ –µ—Å–ª–∏ –±—ã Claude –∏—Ö –∏–∑–≤–ª–µ–∫)
test_organization_data = [
    {
        'organization_name': '–ú—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–µ –∫–∞–∑–µ–Ω–Ω–æ–µ –æ–±—â–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ –ë–æ–±—Ä–æ–≤—Å–∫–∞—è-2 —Å—Ä–µ–¥–Ω—è—è —à–∫–æ–ª–∞',
        'inn': '3427010884',
        'kpp': '342701001',
        'address': '403448, –ë–æ–±—Ä–æ–≤—Å–∫–∏–π 2-–π, –°–µ—Ä–∞—Ñ–∏–º–æ–≤–∏—á–µ—Å–∫–∏–π —Ä–∞–π–æ–Ω, –í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
        'director': '–§–∏—Ä—Å–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –í–∞—Å–∏–ª—å–µ–≤–∏—á',
        'phone': '8(84464)1924',
        'email': 'Serafimbobr2@mail.ru',
        'license': '—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π ‚Ññ 662 –æ—Ç 28 –æ–∫—Ç—è–±—Ä—è 2016 –≥.',
        'other': '–ú–ö–û–£ –ë–æ–±—Ä–æ–≤—Å–∫–∞—è-2 –°–®'
    }
]

# –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ª—é–¥–µ–π
test_people_data = [
    {
        'fio': '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á',
        'birth_date': '15.03.1985',
        'position': '–ò–Ω–∂–µ–Ω–µ—Ä',
        'department': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ª—É–∂–±–∞',
        'other': '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'
    },
    {
        'fio': '–ü–µ—Ç—Ä–æ–≤–∞ –ê–Ω–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞',
        'birth_date': '22.07.1990',
        'position': '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä',
        'department': '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç–¥–µ–ª',
        'other': ''
    }
]

def test_excel_creation():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ Excel —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö"""
    
    processor = PDFProcessor()
    
    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è Excel —Ñ–∞–π–ª–æ–≤...")
    
    # –¢–µ—Å—Ç 1: –î–æ–∫—É–º–µ–Ω—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
    print("\n1Ô∏è‚É£ –¢–µ—Å—Ç: –î–æ–∫—É–º–µ–Ω—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏")
    try:
        org_file = "test_organization.xlsx"
        processor.create_excel_from_data(test_organization_data, org_file)
        print(f"‚úÖ Excel —Ñ–∞–π–ª –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω: {org_file}")
        
        # –í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ
        print("üìä –î–∞–Ω–Ω—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:")
        for key, value in test_organization_data[0].items():
            print(f"   ‚Ä¢ {key}: {value}")
            
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: {e}")
    
    # –¢–µ—Å—Ç 2: –î–∞–Ω–Ω—ã–µ –ª—é–¥–µ–π
    print("\n2Ô∏è‚É£ –¢–µ—Å—Ç: –î–∞–Ω–Ω—ã–µ –ª—é–¥–µ–π")
    try:
        people_file = "test_people.xlsx"
        processor.create_excel_from_data(test_people_data, people_file)
        print(f"‚úÖ Excel —Ñ–∞–π–ª –ª—é–¥–µ–π —Å–æ–∑–¥–∞–Ω: {people_file}")
        
        # –í—ã–≤–æ–¥–∏–º –¥–∞–Ω–Ω—ã–µ
        print("üìä –î–∞–Ω–Ω—ã–µ –ª—é–¥–µ–π:")
        for i, person in enumerate(test_people_data, 1):
            print(f"   –ß–µ–ª–æ–≤–µ–∫ {i}:")
            for key, value in person.items():
                if value:
                    print(f"     ‚Ä¢ {key}: {value}")
                    
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –ª—é–¥–µ–π: {e}")

if __name__ == "__main__":
    test_excel_creation() 